ggplot(aes(x = window, y = value, color = eqm))+
geom_line()
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
ggplot(aes(x = window, y = value, color = daily_eqm))+
geom_line()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(-window), y = value, color = eqm))+
geom_line()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(-as.factor(window)), y = value, color = eqm))+
geom_line()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(as.factor(-window)), y = value, color = eqm))+
geom_line()
?reorder
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(window, decreasing = T), y = value, color = eqm))+
geom_line()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(window, decreasing = TRUE), y = value, color = eqm))+
geom_line()
?arrange
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = arrange(desc(window)), decreasing = TRUE), y = value, color = eqm))+
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = arrange(desc(window)), decreasing = TRUE), y = value, color = eqm)+
geom_line()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = arrange(desc(window)), y = value, color = eqm))+
geom_line()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(window,window, decreasing = T), y = value, color = eqm))+
geom_line()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(window, value, decreasing = T), y = value, color = eqm))+
geom_line()
reorder(window, window, decreasing = T)
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(window, window, decreasing = T), y = value, color = eqm))+
geom_line()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = reorder(window, window, decreasing = T), y = value))+
geom_line(aes(color = eqm))
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1)
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = arrange(desc(window)), y = value))+
geom_line(aes(color = eqm))
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = arrange(as.factor(desc(window))), y = value))+
geom_line(aes(color = eqm))
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = value, color = eqm))+
geom_line()+
scale_x_reverse()
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
ggplot(aes(x = window, y = value, color = daily_eqm))+
geom_line()+
scale_x_reverse()
metrics = NULL
for(i in 0:28){
df = tsdf[1:(length(tsdf$time)-7+i),]
model1 = df %>%
model(ARIMA(temp_max ~ sun_radiation + pdq(0,1,4)+ PDQ(2,0,0)))
model2 = df %>%
model(ARIMA(temp_max ~ windspeed + preciptation + pdq(3,1,1)+ PDQ(1,0,0)))
model3 = df %>%
model(ARIMA(temp_max ~ windspeed + preciptation + sun_radiation + pdq(3,0,2)+ PDQ(1,0,0)))
df_future = tsdf[(length(tsdf$time)-6+i):(length(tsdf$time)),1:2]
df_future = df_future %>%
mutate(preciptation = mean(df$preciptation),
sun_radiation = mean(df$sun_radiation),
windspeed= mean(df$windspeed))
forecast1 = forecast(model1, new_data = df_future)
forecast2 = forecast(model2, new_data = df_future)
forecast3 = forecast(model3, new_data = df_future)
df_test = tsdf[(length(tsdf$time)-6+i):(length(tsdf$time)),1:2]
df_test = df_test %>%
mutate(predict1 = forecast1$.mean,
predict2 = forecast2$.mean,
predict3 = forecast3$.mean)
daily_eqm1 = ((df_test$temp_max - df_test$predict1)^2)[1]
daily_eqm2 = ((df_test$temp_max - df_test$predict2)^2)[1]
daily_eqm3 = ((df_test$temp_max - df_test$predict3)^2)[1]
eqm1 = (sum(df_test$temp_max - df_test$predict1)^2)/nrow(df_test)
eqm2 = (sum(df_test$temp_max - df_test$predict2)^2)/nrow(df_test)
eqm3 = (sum(df_test$temp_max - df_test$predict3)^2)/nrow(df_test)
metrics_new = data.frame(window = (7 - i),
eqm1 = eqm1,
eqm2 = eqm2,
eqm3 = eqm3,
daily_eqm1 = daily_eqm1,
daily_eqm2 = daily_eqm2,
daily_eqm3 = daily_eqm3)
metrics = rbind(metrics,metrics_new)
}
for(i in 0:28){
df = tsdf[1:(length(tsdf$time)-29+i),]
model1 = df %>%
model(ARIMA(temp_max ~ sun_radiation + pdq(0,1,4)+ PDQ(2,0,0)))
model2 = df %>%
model(ARIMA(temp_max ~ windspeed + preciptation + pdq(3,1,1)+ PDQ(1,0,0)))
model3 = df %>%
model(ARIMA(temp_max ~ windspeed + preciptation + sun_radiation + pdq(3,0,2)+ PDQ(1,0,0)))
df_future = tsdf[(length(tsdf$time)-28+i):(length(tsdf$time)),1:2]
df_future = df_future %>%
mutate(preciptation = mean(df$preciptation),
sun_radiation = mean(df$sun_radiation),
windspeed= mean(df$windspeed))
forecast1 = forecast(model1, new_data = df_future)
forecast2 = forecast(model2, new_data = df_future)
forecast3 = forecast(model3, new_data = df_future)
df_test = tsdf[(length(tsdf$time)-28+i):(length(tsdf$time)),1:2]
df_test = df_test %>%
mutate(predict1 = forecast1$.mean,
predict2 = forecast2$.mean,
predict3 = forecast3$.mean)
daily_eqm1 = ((df_test$temp_max - df_test$predict1)^2)[1]
daily_eqm2 = ((df_test$temp_max - df_test$predict2)^2)[1]
daily_eqm3 = ((df_test$temp_max - df_test$predict3)^2)[1]
eqm1 = (sum(df_test$temp_max - df_test$predict1)^2)/nrow(df_test)
eqm2 = (sum(df_test$temp_max - df_test$predict2)^2)/nrow(df_test)
eqm3 = (sum(df_test$temp_max - df_test$predict3)^2)/nrow(df_test)
metrics_new = data.frame(window = (29 - i),
eqm1 = eqm1,
eqm2 = eqm2,
eqm3 = eqm3,
daily_eqm1 = daily_eqm1,
daily_eqm2 = daily_eqm2,
daily_eqm3 = daily_eqm3)
metrics = rbind(metrics,metrics_new)
}
View(metrics)
metrics = NULL
for(i in 0:28){
df = tsdf[1:(length(tsdf$time)-29+i),]
model1 = df %>%
model(ARIMA(temp_max ~ sun_radiation + pdq(0,1,4)+ PDQ(2,0,0)))
model2 = df %>%
model(ARIMA(temp_max ~ windspeed + preciptation + pdq(3,1,1)+ PDQ(1,0,0)))
model3 = df %>%
model(ARIMA(temp_max ~ windspeed + preciptation + sun_radiation + pdq(3,0,2)+ PDQ(1,0,0)))
df_future = tsdf[(length(tsdf$time)-28+i):(length(tsdf$time)),1:2]
df_future = df_future %>%
mutate(preciptation = mean(df$preciptation),
sun_radiation = mean(df$sun_radiation),
windspeed= mean(df$windspeed))
forecast1 = forecast(model1, new_data = df_future)
forecast2 = forecast(model2, new_data = df_future)
forecast3 = forecast(model3, new_data = df_future)
df_test = tsdf[(length(tsdf$time)-28+i):(length(tsdf$time)),1:2]
df_test = df_test %>%
mutate(predict1 = forecast1$.mean,
predict2 = forecast2$.mean,
predict3 = forecast3$.mean)
daily_eqm1 = ((df_test$temp_max - df_test$predict1)^2)[1]
daily_eqm2 = ((df_test$temp_max - df_test$predict2)^2)[1]
daily_eqm3 = ((df_test$temp_max - df_test$predict3)^2)[1]
eqm1 = (sum(df_test$temp_max - df_test$predict1)^2)/nrow(df_test)
eqm2 = (sum(df_test$temp_max - df_test$predict2)^2)/nrow(df_test)
eqm3 = (sum(df_test$temp_max - df_test$predict3)^2)/nrow(df_test)
metrics_new = data.frame(window = (29 - i),
eqm1 = eqm1,
eqm2 = eqm2,
eqm3 = eqm3,
daily_eqm1 = daily_eqm1,
daily_eqm2 = daily_eqm2,
daily_eqm3 = daily_eqm3)
metrics = rbind(metrics,metrics_new)
}
View(metrics)
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = value, color = eqm))+
geom_line()+
scale_x_reverse()
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
ggplot(aes(x = window, y = value, color = daily_eqm))+
geom_line()+
scale_x_reverse()
metrics = NULL
for(i in 0:13){
df = tsdf[1:(length(tsdf$time)-14+i),]
model1 = df %>%
model(ARIMA(temp_max ~ sun_radiation + pdq(0,1,4)+ PDQ(2,0,0)))
model2 = df %>%
model(ARIMA(temp_max ~ windspeed + preciptation + pdq(3,1,1)+ PDQ(1,0,0)))
model3 = df %>%
model(ARIMA(temp_max ~ windspeed + preciptation + sun_radiation + pdq(3,0,2)+ PDQ(1,0,0)))
df_future = tsdf[(length(tsdf$time)-13+i):(length(tsdf$time)),1:2]
df_future = df_future %>%
mutate(preciptation = mean(df$preciptation),
sun_radiation = mean(df$sun_radiation),
windspeed= mean(df$windspeed))
forecast1 = forecast(model1, new_data = df_future)
forecast2 = forecast(model2, new_data = df_future)
forecast3 = forecast(model3, new_data = df_future)
df_test = tsdf[(length(tsdf$time)-13+i):(length(tsdf$time)),1:2]
df_test = df_test %>%
mutate(predict1 = forecast1$.mean,
predict2 = forecast2$.mean,
predict3 = forecast3$.mean)
daily_eqm1 = ((df_test$temp_max - df_test$predict1)^2)[1]
daily_eqm2 = ((df_test$temp_max - df_test$predict2)^2)[1]
daily_eqm3 = ((df_test$temp_max - df_test$predict3)^2)[1]
eqm1 = (sum(df_test$temp_max - df_test$predict1)^2)/nrow(df_test)
eqm2 = (sum(df_test$temp_max - df_test$predict2)^2)/nrow(df_test)
eqm3 = (sum(df_test$temp_max - df_test$predict3)^2)/nrow(df_test)
metrics_new = data.frame(window = (14 - i),
eqm1 = eqm1,
eqm2 = eqm2,
eqm3 = eqm3,
daily_eqm1 = daily_eqm1,
daily_eqm2 = daily_eqm2,
daily_eqm3 = daily_eqm3)
metrics = rbind(metrics,metrics_new)
}
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = value, color = eqm))+
geom_line()+
scale_x_reverse()
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
ggplot(aes(x = window, y = value, color = daily_eqm))+
geom_line()+
scale_x_reverse()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = (value)^(1/2), color = eqm))+
geom_line()+
scale_x_reverse()+
theme(title = "a")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
theme(title = "a")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
labels(x = "Window",
y = "RMSE",
legend = "Proposed models")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
labels(x = "Window",
y = "RMSE",
color = "Proposed models")
?labels
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
labels(x = "Window", y = "RMSE", colour = "Proposed models")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
labels(x = "Window", y = "RMSE", colours = "Proposed models")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
labels(x = "Window", y = "RMSE")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
lab(x = "Window", y = "RMSE", color = "Proposed models")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Proposed models")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line()+
scale_color_manual(values = c("red", "darkblue","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 2)+
scale_color_manual(values = c("red", "darkblue","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 1)+
scale_color_manual(values = c("red", "darkblue","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("red", "darkblue","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 0.7)+
scale_color_manual(values = c("red", "darkblue","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("red", "darkblue","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
ggplot(aes(x = window, y = sqrt(value), color = daily_eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("red", "darkblue","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
ggplot(aes(x = window, y = sqrt(value), color = daily_eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Models")+
theme_bw()+
theme(legend.position = "bottom")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Proposed models")+
theme_bw()+
theme(legend.position = "bottom")
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
ggplot(aes(x = window, y = sqrt(value), color = daily_eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Proposed Models")+
theme_bw()+
theme(legend.position = "bottom")
metrics %>%
select(1:4) %>%
pivot_longer(names_to = "eqm",cols = -1) %>%
mutate(eqm = case_when(eqm=="eqm1"~"Model 1",
eqm=="eqm2"~"Model 2",
eqm=="eqm3"~"Model 3")) %>%
ggplot(aes(x = window, y = sqrt(value), color = eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Proposed models")+
theme_bw()+
theme(legend.position = "bottom")
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
mutate(eqm = case_when(daily_eqm=="daily_eqm1"~"Model 1",
daily_eqm=="daily_eqm2"~"Model 2",
daily_eqm=="daily_eqm3"~"Model 3")) %>%
ggplot(aes(x = window, y = sqrt(value), color = daily_eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Proposed Models")+
theme_bw()+
theme(legend.position = "bottom")
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
mutate(eqm = case_when(daily_eqm=="daily_eqm1"~"Model 1",
daily_eqm=="daily_eqm2"~"Model 2",
daily_eqm=="daily_eqm3"~"Model 3")) %>%
ggplot(aes(x = window, y = sqrt(value), color = daily_eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Proposed Models")+
theme_bw()+
theme(legend.position = "bottom")
metrics %>%
select(c(1,5,6,7))%>%
pivot_longer(names_to = "daily_eqm",cols = -1)%>%
mutate(daily_eqm = case_when(daily_eqm=="daily_eqm1"~"Model 1",
daily_eqm=="daily_eqm2"~"Model 2",
daily_eqm=="daily_eqm3"~"Model 3")) %>%
ggplot(aes(x = window, y = sqrt(value), color = daily_eqm))+
geom_line(size = 0.8)+
scale_color_manual(values = c("darkblue", "red","darkgreen"))+
scale_x_reverse()+
labs(x = "Window", y = "RMSE", color = "Proposed Models")+
theme_bw()+
theme(legend.position = "bottom")
